<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaming2.OG5 - Free Cloud Gaming Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --neon-cyan: #0ff;
            --neon-pink: #f0f;
            --neon-green: #0f0;
            --dark: #0a0a12;
            --darker: #050508;
            --light: #f5f6fa;
        }

        body {
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
        }

        header {
            background: rgba(10, 10, 18, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid var(--neon-cyan);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 2rem;
            font-weight: 700;
            color: var(--light);
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        .logo span {
            background: linear-gradient(to right, var(--neon-cyan), var(--neon-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
        }

        nav a:hover {
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--neon-cyan);
            transition: width 0.3s;
        }

        nav a:hover::after {
            width: 100%;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
        }

        .btn-primary {
            background: var(--neon-cyan);
            color: var(--darker);
        }

        .btn-free {
            background: var(--neon-green);
            color: var(--darker);
            padding: 1rem 2rem;
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 2rem;
            animation: pulse 2s infinite;
        }

        .btn-upload {
            background: var(--neon-pink);
            color: var(--darker);
            padding: 1rem 2rem;
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 1rem;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.7);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(0, 255, 0, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 255, 0, 0);
            }
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.4);
        }

        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1511512578047-dfb367046420?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1471&q=80') no-repeat center center/cover;
            opacity: 0.2;
            z-index: -1;
        }

        .hero-content {
            max-width: 800px;
            z-index: 1;
        }

        h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
            background: linear-gradient(to right, var(--neon-cyan), var(--neon-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
            font-weight: 700;
            letter-spacing: 2px;
        }

        .hero p {
            font-size: 1.4rem;
            margin-bottom: 2rem;
            color: var(--light);
            text-shadow: 0 0 5px var(--neon-cyan);
        }

        .features {
            padding: 5rem 2rem;
            background: var(--darker);
            position: relative;
        }

        .features::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--neon-cyan), transparent);
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            font-size: 2.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            border: 1px solid var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .feature-card i {
            font-size: 3rem;
            color: var(--neon-cyan);
            margin-bottom: 1rem;
            text-shadow: 0 0 10px var(--neon-cyan);
        }

        .games {
            padding: 5rem 2rem;
            position: relative;
        }

        .games::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--neon-pink), transparent);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .game-card:hover {
            transform: scale(1.05);
            border: 1px solid var(--neon-pink);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
        }

        .game-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid var(--neon-pink);
        }

        .game-content {
            padding: 1.5rem;
        }

        .how-it-works {
            padding: 5rem 2rem;
            background: var(--darker);
            position: relative;
        }

        .how-it-works::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--neon-green), transparent);
        }

        .steps {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            width: 250px;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .step:hover {
            transform: translateY(-10px);
            border: 1px solid var(--neon-green);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }

        .step-number {
            font-size: 3rem;
            font-weight: bold;
            color: var(--neon-green);
            margin-bottom: 1rem;
            text-shadow: 0 0 10px var(--neon-green);
        }

        .upload-section {
            padding: 5rem 2rem;
            background: var(--dark);
            position: relative;
        }

        .upload-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--neon-pink), transparent);
        }

        .upload-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid var(--neon-pink);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--neon-cyan);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border-radius: 5px;
            border: 1px solid var(--neon-cyan);
            background: rgba(10, 10, 18, 0.8);
            color: var(--light);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .file-upload {
            border: 2px dashed var(--neon-pink);
            padding: 2rem;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            background: rgba(255, 0, 255, 0.1);
        }

        .file-upload i {
            font-size: 3rem;
            color: var(--neon-pink);
            margin-bottom: 1rem;
        }

        footer {
            background: #050508;
            padding: 3rem 2rem;
            text-align: center;
            border-top: 1px solid var(--neon-cyan);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            text-align: left;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--neon-cyan);
            text-shadow: 0 0 5px var(--neon-cyan);
        }

        .footer-bottom {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(0, 255, 255, 0.2);
        }

        .free-notice {
            text-align: center;
            padding: 2rem;
            background: rgba(0, 255, 0, 0.1);
            border-radius: 10px;
            margin: 2rem auto;
            max-width: 800px;
            border: 1px solid var(--neon-green);
        }

        .free-notice i {
            font-size: 3rem;
            color: var(--neon-green);
            margin-bottom: 1rem;
            text-shadow: 0 0 10px var(--neon-green);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--darker);
            padding: 2rem;
            border-radius: 10px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            border: 2px solid var(--neon-green);
        }

        .modal h2 {
            color: var(--neon-green);
            margin-bottom: 1rem;
        }

        .modal p {
            margin-bottom: 2rem;
        }

        /* User info styles */
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-right: 15px;
        }

        .user-info span {
            color: var(--neon-cyan);
        }

        /* Loading spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--neon-cyan);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Status messages */
        .status-message {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }

        .status-success {
            background: rgba(0, 255, 0, 0.1);
            color: var(--neon-green);
            border: 1px solid var(--neon-green);
        }

        .status-error {
            background: rgba(255, 0, 0, 0.1);
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
        }

        /* Rating stars */
        .star-rating {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .star-rating i {
            color: #555;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star-rating i:hover,
        .star-rating i.active {
            color: gold;
        }

        /* Google Login Button Styles */
        .google-login-container {
            margin: 20px 0;
            text-align: center;
        }

        .divider {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 15px;
            position: relative;
        }

        .divider span {
            background: var(--darker);
            padding: 0 10px;
            position: relative;
            top: -10px;
            color: var(--neon-cyan);
        }

        #google-login-btn {
            background: #fff;
            color: #757575;
            border: 1px solid #ddd;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            font-weight: 500;
            transition: all 0.3s;
        }

        #google-login-btn:hover {
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        #google-login-btn img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        @media (max-width: 768px) {
            nav ul {
                display: none;
            }

            h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1rem;
            }
            
            .logo {
                font-size: 1.5rem;
            }

            .auth-buttons {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <i class="fas fa-gamepad"></i>
            <span>Gaming2.OG5</span>
        </div>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#games-section">Games</a></li>
                <li><a href="#">How It Works</a></li>
                <li><a href="#upload-section">Upload Game</a></li>
                <li><a href="#">Support</a></li>
            </ul>
        </nav>
        <div class="auth-buttons">
            <div class="user-info" id="user-info" style="display: none;">
                <i class="fas fa-user"></i>
                <span id="username"></span>
            </div>
            <button class="btn btn-outline" id="login-btn">Login</button>
            <button class="btn btn-primary" id="signup-btn">Sign Up</button>
            <button class="btn btn-outline" id="logout-btn" style="display: none;">Logout</button>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>GAMING2.OG5</h1>
            <p>Next-Gen Cloud Gaming - Completely Free</p>
            <p>Stream the latest games directly to any device. No downloads, no installations, no payments.</p>
            <button class="btn btn-free" id="play-btn">PLAY FREE NOW <i class="fas fa-play-circle"></i></button>
            <br>
            <button class="btn btn-upload" onclick="scrollToUpload()">UPLOAD YOUR GAME <i class="fas fa-cloud-upload-alt"></i></button>
        </div>
    </section>

    <!-- Free Notice -->
    <section class="free-notice">
        <i class="fas fa-crown"></i>
        <h2>100% FREE CLOUD GAMING</h2>
        <p>Gaming2.OG5 is completely free thanks to our cutting-edge technology and supportive partners. Experience premium gaming without any cost.</p>
    </section>

    <!-- Features Section -->
    <section class="features">
        <h2 class="section-title">Why Gaming2.OG5?</h2>
        <div class="features-grid">
            <div class="feature-card">
                <i class="fas fa-bolt"></i>
                <h3>Instant Play</h3>
                <p>Start playing in seconds with our ultra-low latency technology</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-globe"></i>
                <h3>Play Anywhere</h3>
                <p>Access your games from any device with an internet connection</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-gamepad"></i>
                <h3>Massive Library</h3>
                <p>Hundreds of games from indie titles to AAA blockbusters</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-upload"></i>
                <h3>Share Your Games</h3>
                <p>Upload and share your own creations with the community</p>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works">
        <h2 class="section-title">How It Works</h2>
        <div class="steps">
            <div class="step">
                <div class="step-number">1</div>
                <h3>Create Account</h3>
                <p>Sign up for free in less than 30 seconds</p>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <h3>Choose Game</h3>
                <p>Browse our library and pick any game</p>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <h3>Start Playing</h3>
                <p>Click play and stream instantly to your device</p>
            </div>
            <div class="step">
                <div class="step-number">4</div>
                <h3>Upload Games</h3>
                <p>Share your own games with the community</p>
            </div>
        </div>
    </section>

    <!-- Games Section -->
    <section class="games" id="games-section">
        <h2 class="section-title">Popular Games</h2>
        <div class="games-grid" id="games-container">
            <!-- Games will be loaded dynamically from the backend -->
            <div class="loading-text">Loading games...</div>
        </div>
    </section>

    <!-- Upload Section -->
    <section class="upload-section" id="upload-section">
        <h2 class="section-title">Upload Your Game</h2>
        <div class="upload-container">
            <form id="upload-form">
                <div class="form-group">
                    <label for="game-title">Game Title</label>
                    <input type="text" id="game-title" placeholder="Enter your game title" required>
                </div>
                
                <div class="form-group">
                    <label for="game-description">Game Description</label>
                    <textarea id="game-description" placeholder="Describe your game..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="game-category">Category</label>
                    <select id="game-category" required>
                        <option value="">Select a category</option>
                        <option value="action">Action</option>
                        <option value="adventure">Adventure</option>
                        <option value="rpg">RPG</option>
                        <option value="strategy">Strategy</option>
                        <option value="puzzle">Puzzle</option>
                        <option value="racing">Racing</option>
                        <option value="sports">Sports</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="game-thumbnail">Game Thumbnail</label>
                    <div class="file-upload" onclick="document.getElementById('game-thumbnail').click()">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click to upload a thumbnail image</p>
                        <input type="file" id="game-thumbnail" accept="image/*" style="display: none;" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="game-file">Game File</label>
                    <div class="file-upload" onclick="document.getElementById('game-file').click()">
                        <i class="fas fa-file-archive"></i>
                        <p>Click to upload your game files (ZIP format)</p>
                        <input type="file" id="game-file" accept=".zip" style="display: none;" required>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-upload" id="submit-btn">
                    Submit Game <i class="fas fa-paper-plane"></i>
                </button>
                <div id="upload-status"></div>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Gaming2.OG5</h3>
                <p>The ultimate free cloud gaming experience. Play your favorite games anywhere, on any device.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#games-section">Games</a></li>
                    <li><a href="#">How It Works</a></li>
                    <li><a href="#upload-section">Upload Game</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <div class="social-icons">
                    <i class="fab fa-discord"></i>
                    <i class="fab fa-twitter"></i>
                    <i class="fab fa-instagram"></i>
                    <i class="fab fa-youtube"></i>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Gaming2.OG5 Free Cloud Gaming. All rights reserved.</p>
        </div>
    </footer>

    <!-- Upload Success Modal -->
    <div class="modal" id="success-modal">
        <div class="modal-content">
            <i class="fas fa-check-circle" style="font-size: 4rem; color: var(--neon-green);"></i>
            <h2>Game Submitted Successfully!</h2>
            <p>Your game has been uploaded and is now under review. You will be notified once it's published on the platform.</p>
            <button class="btn btn-primary" onclick="closeModal()">Continue Browsing</button>
        </div>
    </div>

    <!-- Login/Signup Modal -->
    <div class="modal" id="auth-modal">
        <div class="modal-content">
            <h2 id="auth-modal-title">Login</h2>
            <form id="auth-form">
                <div class="form-group">
                    <label for="auth-username">Username</label>
                    <input type="text" id="auth-username" required>
                </div>
                <div class="form-group">
                    <label for="auth-password">Password</label>
                    <input type="password" id="auth-password" required>
                </div>
                <div id="auth-error" class="status-message status-error" style="display: none;"></div>
                <button type="submit" class="btn btn-primary" id="auth-submit-btn">Login</button>
            </form>
            
            <!-- Google Login Button -->
            <div class="google-login-container">
                <div class="divider">
                    <span>OR</span>
                </div>
                <button 
                    id="google-login-btn" 
                >
                    <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo">
                    Sign in with Google
                </button>
            </div>
            
            <p id="auth-switch">Don't have an account? <a href="#" id="auth-switch-link">Sign up</a></p>
        </div>
    </div>

    <script>
        // API base URL - points to your backend
        const API_BASE_URL = 'http://localhost:5000/api';
        
        // Global state
        let currentUser = null;
        let authToken = localStorage.getItem('authToken') || '';
        let isLoginMode = true;

        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            checkAuthStatus();
            
            // Load games from backend
            loadGames();
            
            // Set up event listeners
            setupEventListeners();
            
            // Check for Google auth token in URL
            checkForGoogleToken();
            
            // Add subtle animation to the hero text
            const heroText = document.querySelector('h1');
            heroText.style.opacity = 0;
            
            let opacity = 0;
            const fadeIn = setInterval(() => {
                opacity += 0.02;
                heroText.style.opacity = opacity;
                if (opacity >= 1) clearInterval(fadeIn);
            }, 30);
        });

        // Check for Google auth token in URL
        function checkForGoogleToken() {
            const urlParams = new URLSearchParams(window.location.search);
            const googleToken = urlParams.get('token');
            
            if (googleToken) {
                // Store the token and update UI
                authToken = googleToken;
                localStorage.setItem('authToken', authToken);
                
                // Remove token from URL
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // Fetch user info
                fetchUserInfo();
            }
        }

        // Fetch user info after Google login
        async function fetchUserInfo() {
            try {
                const response = await fetch(`${API_BASE_URL}/users/me`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    currentUser = user;
                    updateUIForUser(user);
                    alert('Google login successful!');
                    
                    // Close the auth modal if open
                    document.getElementById('auth-modal').style.display = 'none';
                }
            } catch (error) {
                console.error('Error fetching user info:', error);
            }
        }

        // Check authentication status
        async function checkAuthStatus() {
            try {
                if (authToken) {
                    // Verify token with backend
                    const response = await fetch(`${API_BASE_URL}/users/me`, {
                        headers: {
                            'Authorization': `Bearer ${authToken}`
                        }
                    });
                    
                    if (response.ok) {
                        const user = await response.json();
                        currentUser = user;
                        updateUIForUser(user);
                    } else {
                        localStorage.removeItem('authToken');
                        authToken = '';
                    }
                }
            } catch (error) {
                console.error('Auth check error:', error);
            }
        }

        // Update UI based on user authentication status
        function updateUIForUser(user) {
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const userInfo = document.getElementById('user-info');
            const usernameSpan = document.getElementById('username');
            
            if (user) {
                loginBtn.style.display = 'none';
                signupBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
                userInfo.style.display = 'flex';
                usernameSpan.textContent = user.username;
            } else {
                loginBtn.style.display = 'block';
                signupBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
                userInfo.style.display = 'none';
            }
        }

        // Load games from backend
        async function loadGames() {
            try {
                const response = await fetch(`${API_BASE_URL}/games`);
                const games = await response.json();
                
                const gamesContainer = document.getElementById('games-container');
                gamesContainer.innerHTML = '';
                
                if (games.length === 0) {
                    gamesContainer.innerHTML = '<div class="no-games">No games available yet. Be the first to upload one!</div>';
                    return;
                }
                
                games.forEach(game => {
                    const gameCard = document.createElement('div');
                    gameCard.className = 'game-card';
                    gameCard.innerHTML = `
                        <img src="${game.thumbnailUrl || 'https://images.unsplash.com/photo-1640079421314-c4fee769a92e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80'}" alt="${game.title}">
                        <div class="game-content">
                            <h3>${game.title}</h3>
                            <p>${game.category} • ${game.averageRating || 'No'} ratings</p>
                            <p class="uploader">By: ${game.uploader || 'Unknown'}</p>
                            <button class="btn btn-outline play-game-btn" data-game-id="${game._id}">Play Now</button>
                            ${currentUser ? `
                                <div class="rating-section">
                                    <p>Rate this game:</p>
                                    <div class="star-rating" data-game-id="${game._id}">
                                        <i class="fas fa-star" data-rating="1"></i>
                                        <i class="fas fa-star" data-rating="2"></i>
                                        <i class="fas fa-star" data-rating="3"></i>
                                        <i class="fas fa-star" data-rating="4"></i>
                                        <i class="fas fa-star" data-rating="5"></i>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                    gamesContainer.appendChild(gameCard);
                });
                
                // Add event listeners to play buttons
                document.querySelectorAll('.play-game-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const gameId = e.target.getAttribute('data-game-id');
                        playGame(gameId);
                    });
                });
                
                // Add event listeners to rating stars
                document.querySelectorAll('.star-rating i').forEach(star => {
                    star.addEventListener('click', (e) => {
                        const rating = parseInt(e.target.getAttribute('data-rating'));
                        const gameId = e.target.parentElement.getAttribute('data-game-id');
                        rateGame(gameId, rating);
                    });
                });
                
            } catch (error) {
                console.error('Error loading games:', error);
                document.getElementById('games-container').innerHTML = 
                    '<div class="status-message status-error">Failed to load games. Please try again later.</div>';
            }
        }

        // Play a game
        function playGame(gameId) {
            // This would typically launch the game in your cloud gaming system
            alert(`Starting game with ID: ${gameId}. In a real implementation, this would launch the game.`);
        }

        // Rate a game
        async function rateGame(gameId, rating) {
            try {
                const response = await fetch(`${API_BASE_URL}/ratings`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        gameId,
                        rating
                    })
                });
                
                if (response.ok) {
                    alert('Thanks for your rating!');
                    loadGames(); // Reload games to show updated ratings
                } else {
                    alert('Failed to submit rating. Please try again.');
                }
            } catch (error) {
                console.error('Error rating game:', error);
                alert('An error occurred while submitting your rating.');
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Auth buttons
            document.getElementById('login-btn').addEventListener('click', () => openAuthModal(true));
            document.getElementById('signup-btn').addEventListener('click', () => openAuthModal(false));
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // Auth form submission
            document.getElementById('auth-form').addEventListener('submit', handleAuth);
            
            // Auth mode switch
            document.getElementById('auth-switch-link').addEventListener('click', (e) => {
                e.preventDefault();
                toggleAuthMode();
            });
            
            // Upload form submission
            document.getElementById('upload-form').addEventListener('submit', handleGameUpload);
            
            // Play free button
            document.getElementById('play-btn').addEventListener('click', () => {
                document.getElementById('games-section').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Google login button
            document.getElementById('google-login-btn').addEventListener('click', () => {
                window.location.href = `${API_BASE_URL}/auth/google`;
            });
        }

        // Open auth modal
        function openAuthModal(isLogin) {
            isLoginMode = isLogin;
            const modal = document.getElementById('auth-modal');
            const title = document.getElementById('auth-modal-title');
            const submitBtn = document.getElementById('auth-submit-btn');
            const switchText = document.getElementById('auth-switch');
            const switchLink = document.getElementById('auth-switch-link');
            
            if (isLogin) {
                title.textContent = 'Login';
                submitBtn.textContent = 'Login';
                switchText.innerHTML = 'Don\'t have an account? <a href="#" id="auth-switch-link">Sign up</a>';
            } else {
                title.textContent = 'Sign Up';
                submitBtn.textContent = 'Sign Up';
                switchText.innerHTML = 'Already have an account? <a href="#" id="auth-switch-link">Login</a>';
            }
            
            // Reattach event listener to the new link
            document.getElementById('auth-switch-link').addEventListener('click', (e) => {
                e.preventDefault();
                toggleAuthMode();
            });
            
            // Clear previous errors
            document.getElementById('auth-error').style.display = 'none';
            
            modal.style.display = 'flex';
        }

        // Toggle between login and signup modes
        function toggleAuthMode() {
            openAuthModal(!isLoginMode);
        }

        // Handle authentication
        async function handleAuth(e) {
            e.preventDefault();
            
            const username = document.getElementById('auth-username').value;
            const password = document.getElementById('auth-password').value;
            const errorDiv = document.getElementById('auth-error');
            const submitBtn = document.getElementById('auth-submit-btn');
            
            // Show loading state
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<div class="loading"></div> Processing...';
            submitBtn.disabled = true;
            errorDiv.style.display = 'none';
            
            try {
                const endpoint = isLoginMode ? '/auth/login' : '/auth/register';
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Save token and user data
                    authToken = data.token;
                    localStorage.setItem('authToken', authToken);
                    currentUser = data.user;
                    
                    // Update UI
                    updateUIForUser(data.user);
                    
                    // Close modal
                    document.getElementById('auth-modal').style.display = 'none';
                    
                    // Reload games to show rating options
                    loadGames();
                    
                    // Show success message
                    alert(isLoginMode ? 'Login successful!' : 'Account created successfully!');
                } else {
                    // Show error
                    errorDiv.textContent = data.message || 'An error occurred';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Auth error:', error);
                errorDiv.textContent = 'Network error. Please try again.';
                errorDiv.style.display = 'block';
            } finally {
                // Restore button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Logout
        function logout() {
            localStorage.removeItem('authToken');
            authToken = '';
            currentUser = null;
            updateUIForUser(null);
            alert('Logged out successfully');
        }

        // Handle game upload
        async function handleGameUpload(e) {
            e.preventDefault();
            
            // Check if user is logged in
            if (!currentUser) {
                alert('Please log in to upload a game');
                openAuthModal(true);
                return;
            }
            
            const formData = new FormData();
            formData.append('title', document.getElementById('game-title').value);
            formData.append('description', document.getElementById('game-description').value);
            formData.append('category', document.getElementById('game-category').value);
            formData.append('thumbnail', document.getElementById('game-thumbnail').files[0]);
            formData.append('gameFile', document.getElementById('game-file').files[0]);
            
            const submitBtn = document.getElementById('submit-btn');
            const statusDiv = document.getElementById('upload-status');
            
            // Show loading state
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<div class="loading"></div> Uploading...';
            submitBtn.disabled = true;
            statusDiv.innerHTML = '';
            
            try {
                const response = await fetch(`${API_BASE_URL}/games/upload`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Show success message
                    statusDiv.innerHTML = '<div class="status-message status-success">Game uploaded successfully!</div>';
                    
                    // Reset form
                    document.getElementById('upload-form').reset();
                    
                    // Show success modal
                    document.getElementById('success-modal').style.display = 'flex';
                    
                    // Reload games list
                    loadGames();
                } else {
                    statusDiv.innerHTML = `<div class="status-message status-error">${data.message || 'Upload failed'}</div>`;
                }
            } catch (error) {
                console.error('Upload error:', error);
                statusDiv.innerHTML = '<div class="status-message status-error">Network error. Please try again.</div>';
            } finally {
                // Restore button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Scroll to upload section
        function scrollToUpload() {
            document.getElementById('upload-section').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('success-modal').style.display = 'none';
            document.getElementById('auth-modal').style.display = 'none';
        }
        
        // File upload interaction
        const fileInputs = document.querySelectorAll('input[type="file"]');
        fileInputs.forEach(input => {
            input.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const uploadArea = this.parentElement;
                    uploadArea.innerHTML = `<i class="fas fa-check-circle" style="color: var(--neon-green);"></i><p>${this.files[0].name} selected</p>`;
                }
            });
        });
    </script>
</body>
</html>